1. 关于 Offset 读取到 -127

这不是芯片错误，这通常是“无效数据”或“读取失败”的表现。

物理现实：BQ76920 的 ADC 偏移（Offset）通常只有几个 mV（正常范围是 -20 到 +20 左右）。

为什么是 -127：在 8 位有符号数中，0x81 就是 -127。当你读到这个极值时，通常是因为 I2C 通讯瞬间抖动，或者芯片内部该寄存器尚未完成初始化。

为什么要给 0：如果程序拿着 -127 去计算，你的电压会瞬间跳变 127mV，这足以触发错误的欠压保护。在工程上，当我们发现读取到的校准值“不合常理”时，强制给一个中性值（0）是最安全的“降级处理”方案。

2. Gain 为什么会有 1% 的偏差？

你读取到 374 ($374 \mu V/LSB$)，但实际电压差了 1.0102 倍。

内因：芯片内部的带隙基准电压源（Bandgap Reference）在出厂时有 $\pm1\%$ 左右的容差。

外因：PCB 走线电阻。采样点到芯片引脚之间的铜箔也是有电阻的，在大电流或高输入阻抗下会产生微小的压降（IR Drop）。

软件补偿：bq_gain * 1.0102f 就是所谓的“单点校准”。既然硬件已经定型，通过软件乘一个系数是最快、成本最低的修正方法。

3. cc_raw 为什么可以直接减 352？

这叫**“去皮”（Tare）**，就像你用电子秤称重前先按一下清零键一样。

零点漂移：库仑计是一个极其灵敏的积分器。即使没有电流，芯片内部的运算放大器也会有极小的失调电压。

环境噪声：PCB 上的电磁干扰会被 $3m\Omega$ 的电阻放大。

实测为王：你在零电流时读到 352，说明这 352 个 LSB 是“背景噪音”。减去它，得到的才是真正的负载电流。

4. 10k NTC 为什么要用简单的斜率公式？

这就是**“工程近似”**的艺术。

Beta 公式 ($B=3435$) 的痛苦：标准公式是 $1/T = 1/T_0 + (1/B) \cdot \ln(R/R_0)$。这涉及到对数（$\ln$）和倒数运算。在单片机里跑浮点 $\ln$ 非常消耗资源，甚至可能导致你之前遇到的死机。

线性化的秘密：

NTC 在全局（-40°C 到 125°C）确实是非常弯曲的曲线。

但在室温附近（15°C - 35°C），这段曲线看起来非常像一条直线。

两点斜率的威力：你通过 20°C 和手摸升温这两个点，实际上是在该温度区间做了一个一阶泰勒展开。对于 BMS 监控来说，±0.5 度的误差完全可以接受，而换来的是极快的运行速度和极高的稳定性。